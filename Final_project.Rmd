---
title: "Final Project Part 2"
author: "Ruigang Jiang"
date: "`r Sys.Date()`"
output: html_document
params:
  production:FALSE
---
### Purpose
This data set presents the provisional death counts of diabetes, corona virus disease 2019 (COVID-19), and other specific causes of death by month, sex, and age from 2020. This project will focus on analyzing the relative risk of death in different age groups and the relative risk of death in different sexes due to COVID-19 and Diabetes.

### Data Import
```{r,echo = FALSE, warning = FALSE, message = FALSE}
here::i_am("Final_project.Rmd")
data <- readRDS(
  file = here::here("output/data_clean.rds")
)

```

### The relative risk of death in different age groups.
Count the total number of people who died of different diseases in each age group (add together men and women in the same age group).

#### Data Clean; Counting the number of death in different age groups.
```{r, echo = FALSE, warning = FALSE, message = FALSE}
library(dplyr)

df_combined <- data %>%
  group_by(AgeGroup) %>%
  summarise(across(where(is.numeric), sum, na.rm = TRUE))

df_new <- df_combined[, !names(df_combined) %in% c("Date_Of_Death_Year", "Date_Of_Death_Month")]

```

```{r, echo = FALSE, warning = FALSE, message = FALSE}
library(ggplot2)

ggplot(df_new, aes(x = AgeGroup, y = COVID19)) +
  geom_bar(stat = "identity", fill = "steelblue") +
  labs(title = "Death due to COVID-19 Relate to Different Age Group",
       x = "Age Group",
       y = "COVID-19 Death Number") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

```{r, echo = FALSE, warning = FALSE, message = FALSE}
ggplot(df_new, aes(x = AgeGroup, y = Diabetes.uc)) +
  geom_bar(stat = "identity", fill = "red") +
  labs(title = "Death due to diabetes Relate to Different Age Group",
       x = "Age Group",
       y = "Diabetes Death Number") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

Generates a table showing descriptive statistics of COVID-19 and diabetes mortality data in different age groups, including overall statistics and p-values for comparisons between groups.

```{r, echo = FALSE, warning = FALSE, message = FALSE}
library(gtsummary)

table_one <- df_new |>
  select("AgeGroup", "COVID19", "Diabetes.uc") |>
  tbl_summary(by = AgeGroup) |>
  modify_spanning_header(c("stat_1", "stat_2") ~ "**Death rank in COVID19 and Diabetes**") |>
  add_overall() |>
  add_p()

table_one

```


